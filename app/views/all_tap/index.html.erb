<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Taper les tous !</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <%# <script src="jeu.js"></script> %>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script>
    $(document).ready(function() {
  var generateColor, generateLetters, score, scoreBefore, stopGenLetter;
  score = 0;
  stopGenLetter = false;
  generateColor = function() {
    var c, color, le, values;
    color = '';
    values = ['a', 'b', 'c', 'd', 'e', 'f', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0'];
    c = 0;
    while (c < 6) {
      le = Math.floor(Math.random() * 10);
      color += values[le];
      c++;
    }
    return color;
  };
  generateLetters = function() {
    var chars, color, i, left, num, randomstring, string_length, top;
    if (stopGenLetter === false) {
      color = generateColor();
      chars = 'abcdefghijklmnopqrstuvwxyz';
      string_length = 1;
      randomstring = '';
      i = 0;
      while (i < string_length) {
        num = Math.floor(Math.random() * chars.length);
        randomstring += chars.substring(num, num + 1);
        i++;
      }
      top = Math.floor(Math.random() * 370);
      left = Math.floor(Math.random() * 730);
      $('#zoneJeu').append('<span class="letter letter' + randomstring + '" style="left: ' + left + 'px; top: ' + top + 'px; background-color:#' + color + '">' + randomstring + '</span>');
      setTimeout(generateLetters, 500);
    } else {
      clearTimeout();
    }
  };
  if (typeof sessionStorage !== 'undefined') {
    if ('monScore' in sessionStorage) {
      scoreBefore = sessionStorage.getItem('monScore');
      $('#scoreBefore span').html(scoreBefore);
    }
  } else {
    alert('sessionStorage n\'est pas supporté');
  }
  $('#start').click(function() {
    var seconde, timer;
    timer = function() {
      var seconde;
      if (seconde < 0) {
        seconde = 0;
        $('#countdown').html('Jeu terminé !');
        stopGenLetter = true;
        $('.letter').hide();
        $('#zoneJeu').append('<div id="newGame"><a href="index.html"> Rejouer ?</a></div>');
        if (typeof sessionStorage !== 'undefined') {
          sessionStorage.setItem('monScore', score);
          alert('Votre score est enregistré !');
        } else {
          alert('sessionStorage n\'est pas supporté');
        }
      } else {
        setTimeout(timer, 1000);
        $('#countdown').html('Timer : ' + seconde);
        seconde--;
      }
    };
    $(this).hide();
    $('#score').show();
    generateLetters();
    seconde = 20;
    timer();
  });
  $(document).keypress(function(touche) {
    var appui;
    var appui;
    if (seconde > 0) {
      appui = touche.which || touche.keyCode;
      if (appui !== 32 && appui !== 43 && appui !== 13 && appui !== 42) {
        appui = String.fromCharCode(appui);
        $('.letter' + appui).animate({
          'top': '20px',
          'opacity': 0
        }, 'slow');
        $('.letter' + appui).fadeOut('slow').hide('slow', function() {
          score += 1;
          $('#score span').html(score);
          $(this).remove();
        });
      }
    }
  });
});

// ---
// generated by coffee-script 1.9.2
    </script>
    <!-- Normalize -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <%# <link rel="stylesheet" href="css/style.css"> %>

</head>

<body>

    <header id="bandeau">
        <h1 id="nameJeu">Tapez les tous !</h1>
        <p id="scoreBefore">Score précédent : <span>0</span></p>
    </header>

    <div class="playBoard">
        <div id="score">Votre score : <span>0</span></div>
        <div id="countdown"></div>
    </div>

    <div id="zoneJeu">
        <div id="start">Lancer le jeu</div>
    </div>

</body>

</html>